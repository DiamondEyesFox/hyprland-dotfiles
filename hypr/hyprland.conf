################
### MONITORS ###
################
monitor=,preferred,auto,auto

###############
### COLORS ###
###############
source = ~/.config/hypr/colors.conf

###################
### MY PROGRAMS ###
###################
$terminal = kitty
$fileManager = dolphin
$menu = rofi -show drun

#################
### AUTOSTART ###
#################
# Start waybar first so tray is ready
exec-once = waybar
# Wallpaper - using swww instead of hyprpaper (faster)
exec-once = swww-daemon
exec-once = swww img ~/Pictures/Wallpapers/current.jpg --transition-type fade --transition-duration 1
# exec-once = hyprpaper
# exec-once = swaync  # Now managed by systemd (systemctl --user enable swaync)
# exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec-once = $terminal
# Session management - using hyprsession instead of custom scripts
exec-once = hyprsession
# exec-once = ~/.config/hypr/scripts/auto-restore.sh
# exec-once = waypaper --restore
exec-once = ~/.config/hypr/scripts/wallpaper-watcher.sh
# Idle management and screen locking
# exec-once = hypridle  # Disabled - using manual lock only (SUPER+L)
# Pyprland - Advanced window management
exec-once = pypr
# SwayOSD - On-screen display for volume/brightness
exec-once = swayosd-server
# Clipboard history manager
exec-once = wl-paste --watch cliphist store

# Tray applications - start after waybar with delays
exec-once = sleep 2 && nordvpn-gui
exec-once = sleep 2 && steam -silent
# exec-once = copyq --start-server hide  # Disabled - using swaync clipboard instead


#############################
### ENVIRONMENT VARIABLES ###
#############################
env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = QT_QPA_PLATFORM,wayland
env = MOZ_ENABLE_WAYLAND,1
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland

#####################
### LOOK AND FEEL ###
#####################
general {
    gaps_in = 5
    gaps_out = 15
    border_size = 2
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)
    resize_on_border = false
    allow_tearing = false
    layout = dwindle
}

decoration {
    rounding = 10
    rounding_power = 2
    active_opacity = 1.0
    inactive_opacity = 1.0

    shadow {
        enabled = true
        range = 4
        render_power = 3
        color = rgba(1a1a1aee)
    }

    blur {
        enabled = true
        size = 3
        passes = 1
        vibrancy = 0.1696
    }
}

animations {
    enabled = yes, please :)
    bezier = easeOutQuint,0.23,1,0.32,1
    bezier = easeInOutCubic,0.65,0.05,0.36,1
    bezier = linear,0,0,1,1
    bezier = almostLinear,0.5,0.5,0.75,1.0
    bezier = quick,0.15,0,0.1,1

    animation = global, 1, 10, default
    animation = border, 1, 5.39, easeOutQuint
    animation = windows, 1, 4.79, easeOutQuint
    animation = windowsIn, 1, 4.1, easeOutQuint, popin 87%
    animation = windowsOut, 1, 1.49, linear, popin 87%
    animation = fadeIn, 1, 1.73, almostLinear
    animation = fadeOut, 1, 1.46, almostLinear
    animation = fade, 1, 3.03, quick
    animation = layers, 1, 3.81, easeOutQuint
    animation = layersIn, 1, 4, easeOutQuint, fade
    animation = layersOut, 1, 1.5, linear, fade
    animation = fadeLayersIn, 1, 1.79, almostLinear
    animation = fadeLayersOut, 1, 1.39, almostLinear
    animation = workspaces, 1, 1.94, almostLinear, fade
    animation = workspacesIn, 1, 1.21, almostLinear, fade
    animation = workspacesOut, 1, 1.94, almostLinear, fade
}

dwindle {
    pseudotile = true
    preserve_split = true
}

master {
    new_status = master
}

misc {
    force_default_wallpaper = -1
    disable_hyprland_logo = true
    disable_splash_rendering = true
}

#############
### INPUT ###
#############
input {
    kb_layout = us
    follow_mouse = 1
    sensitivity = 0
}

###################
### KEYBINDINGS ###
###################
# Use SUPER directly to avoid var expansion issues
# Launchers
bind = SUPER, Return, exec, $terminal
bind = ALT, Space, exec, ~/.config/hypr/scripts/rofi-toggle.sh
bind = SUPER, E, exec, $fileManager

# Window management
bind = SUPER, Q, killactive
bind = SUPER, V, togglefloating
bind = SUPER, F, fullscreen, 0
bind = SUPER, L, exec, hyprlock
# bind = SUPER, M, exec, ~/.config/hypr/scripts/exit-hyprland.sh  # Unbound to avoid accidental power off

# Focus
bind = SUPER, left,  movefocus, l
bind = SUPER, right, movefocus, r
bind = SUPER, up,    movefocus, u
bind = SUPER, down,  movefocus, d

# Move windows
bind = SUPER SHIFT, left, movewindow, l
bind = SUPER SHIFT, right, movewindow, r
bind = SUPER SHIFT, up, movewindow, u
bind = SUPER SHIFT, down, movewindow, d

# Toggle split direction (horizontal â†” vertical)
bind = SUPER, T, togglesplit

# Workspaces
bind = SUPER, 1, workspace, 1
bind = SUPER, 2, workspace, 2
bind = SUPER, 3, workspace, 3
bind = SUPER, 4, workspace, 4
bind = SUPER, 5, workspace, 5
bind = SUPER, 6, workspace, 6
bind = SUPER, 7, workspace, 7
bind = SUPER, 8, workspace, 8
bind = SUPER, 9, workspace, 9
bind = SUPER, 0, workspace, 10

bind = SUPER SHIFT, 1, movetoworkspace, 1
bind = SUPER SHIFT, 2, movetoworkspace, 2
bind = SUPER SHIFT, 3, movetoworkspace, 3
bind = SUPER SHIFT, 4, movetoworkspace, 4
bind = SUPER SHIFT, 5, movetoworkspace, 5
bind = SUPER SHIFT, 6, movetoworkspace, 6
bind = SUPER SHIFT, 7, movetoworkspace, 7
bind = SUPER SHIFT, 8, movetoworkspace, 8
bind = SUPER SHIFT, 9, movetoworkspace, 9
bind = SUPER SHIFT, 0, movetoworkspace, 10

# Special workspace (scratchpad)
bind = SUPER, S, togglespecialworkspace, magic
bind = SUPER SHIFT, S, movetoworkspace, special:magic

# PiP special workspace
bind = SUPER, P, togglespecialworkspace, pip

# Workspace overview script
bind = SUPER, grave, exec, ~/.config/hypr/scripts/workspace-overview.sh

# Wallpaper gallery (visual thumbnail browser) - toggle on/off
bind = SUPER, W, exec, pgrep -x nsxiv > /dev/null && pkill nsxiv || ~/.config/hypr/scripts/wallpaper-gallery.sh

# Notification center
bind = SUPER, N, exec, swaync-client -t -sw

# Clipboard manager
bind = SUPER, C, exec, pgrep -x rofi > /dev/null && pkill rofi || (cliphist list | rofi -dmenu -p "Clipboard History" | cliphist decode | wl-copy)

# Pyprland - Scratchpads and window management
bind = SUPER, Space, exec, pypr toggle term        # Dropdown terminal
bind = CTRL, Space, exec, pypr toggle claude       # Claude Code AI assistant
bind = SUPER, K, exec, pypr toggle keybinds        # Keybinds cheatsheet
bind = SUPER, B, exec, pypr toggle btop            # System monitor
bind = SUPER SHIFT, V, exec, pypr toggle volume    # Volume control
bind = SUPER, M, exec, pypr toggle music           # Plexamp music player
bind = SUPER, equal, exec, pypr toggle calc        # Calculator
bind = SUPER, I, exec, pypr toggle notes           # Quick notes
bind = SUPER, D, exec, pypr toggle files           # File manager (Dolphin)
bind = SUPER, Y, exec, pypr toggle yazi            # File manager (Yazi terminal)
bind = SUPER, A, exec, pypr expose                 # Expose all windows (Mission Control)

# Session Management
bind = SUPER SHIFT, grave, exec, ~/.config/hypr/scripts/save-session.sh
bind = SUPER CTRL, grave, exec, ~/.config/hypr/scripts/restore-session.sh

# Scroll through workspaces
bind = SUPER, mouse_down, workspace, e+1
bind = SUPER, mouse_up,   workspace, e-1

# Move/resize with mouse
bindm = SUPER, mouse:272, movewindow
bindm = SUPER, mouse:273, resizewindow

# Media / brightness (using swayosd for OSD display)
bindel = ,XF86AudioRaiseVolume, exec, swayosd-client --output-volume raise
bindel = ,XF86AudioLowerVolume, exec, swayosd-client --output-volume lower
bindel = ,XF86AudioMute,        exec, swayosd-client --output-volume mute-toggle
bindel = ,XF86AudioMicMute,     exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindel = ,XF86MonBrightnessUp,   exec, swayosd-client --brightness raise
bindel = ,XF86MonBrightnessDown, exec, swayosd-client --brightness lower

# Player controls
bindl = , XF86AudioNext,  exec, playerctl next
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioPlay,  exec, playerctl play-pause
bindl = , XF86AudioPrev,  exec, playerctl previous

# Additional media controls (Right Control + arrows) - synced with waybar player selection
bind = RCTRL, left, exec, ~/.config/hypr/scripts/playerctl-selected.sh previous
bind = RCTRL, down, exec, ~/.config/hypr/scripts/playerctl-selected.sh play-pause
bind = RCTRL, right, exec, ~/.config/hypr/scripts/playerctl-selected.sh next
bind = RCTRL, up, exec, ~/.config/waybar/scripts/mediaplayer-enhanced.py 1

# Screenshots (Mac-style) - using grim + slurp for Wayland
bind = ALT SHIFT, 3, exec, grim ~/Pictures/Screenshots/screenshot_$(date +%Y%m%d_%H%M%S).png && notify-send "Screenshot saved"
bind = ALT SHIFT, 4, exec, grim -g "$(slurp)" ~/Pictures/Screenshots/screenshot_region_$(date +%Y%m%d_%H%M%S).png && notify-send "Region screenshot saved"
bind = ALT SHIFT, 5, exec, ~/.config/hypr/scripts/screenshot-menu.sh
bind = , Print, exec, grim ~/Pictures/Screenshots/screenshot_$(date +%Y%m%d_%H%M%S).png

##############################
### WINDOWS AND WORKSPACES ###
##############################
windowrule = suppressevent maximize, class:.*
windowrule = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

# Wallpaper browser on workspace 8
windowrulev2 = workspace 8, class:(eww-wallpaper-browser)
windowrulev2 = float, class:(eww-wallpaper-browser)

# Waypaper transparency
windowrulev2 = opacity 0.8, class:(waypaper)

# Obsidian transparency
windowrulev2 = opacity 0.8 0.7, class:(obsidian)

# Vesktop transparency
windowrulev2 = opacity 0.8 0.7, class:(vesktop)

# Steam transparency
windowrulev2 = opacity 0.8 0.7, class:(steam)

# Picture-in-Picture windows - move to special workspace
windowrulev2 = float,pin,title:^(Picture in picture)$
windowrulev2 = workspace special:pip, title:^(Picture in picture)$

# Plexamp scratchpad - float only in special workspace
windowrulev2 = float, class:^(Plexamp)$, workspace:special:scratch_music

# bind = SUPER, Tab, overview:toggle  # Hyprspace workspace overview (disabled - invalid dispatcher)


# MX Master 3S gesture button for workspace overview
bind = , mouse:277, exec, pypr expose  # Gesture button - Mission Control (pyprland)

# Windows-style middle-click autoscroll
# Note: This requires a program like 'middleclickscroll' or similar
# Hyprland doesn't have built-in autoscroll, but we can bind middle click actions

# Enable Windows-style middle-click autoscroll for browsers
env = CHROME_FLAGS,--enable-blink-features=MiddleClickAutoscroll
env = ELECTRON_FLAGS,--enable-blink-features=MiddleClickAutoscroll

# Disable middle-click paste (optional - enables autoscroll without accidental pastes)
misc {
    middle_click_paste = false
}
